"use strict";var _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},_createClass=function(){function e(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(t,n,o){return n&&e(t.prototype,n),o&&e(t,o),t}}();function _defineProperty(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var TemplateFetcher=function(){function e(){_classCallCheck(this,e);var t=this;this.settings={action:"/fetch-template",fetch:!0,csrf:{name:void 0!==window.csrfTokenName?window.csrfTokenName:"X-CSRF-Token",token:void 0!==window.csrfTokenValue?window.csrfTokenValue:null},dev:!1};for(var n=arguments.length,o=Array(n),r=0;r<n;r++)o[r]=arguments[r];o.length&&o.forEach(function(e){switch(void 0===e?"undefined":_typeof(e)){case"boolean":t.settings.fetch=e;break;case"string":t.settings.action=e;break;case"object":t.settings=Object.assign({},t.settings,e)}}),this.settings.dev&&console.log(this.settings)}return _createClass(e,[{key:"template",value:function(e,t){void 0!==e&&void 0!==t&&(this.settings.fetch?this.fetcher.fetchMethod(this,e,t):this.fetcher.ajaxMethod(this,e,t))}},{key:"fetcher",get:function(){return{ajaxMethod:function(e,t,n){$.ajax({type:"POST",dataType:"json",url:e.settings.action,data:t,headers:_defineProperty({},e.settings.csrf.name,e.settings.csrf.token),success:function(t){!0===t.success?(n(t),e.settings.dev&&console.log("Success:",t)):console.error("Error:",t)},error:function(e){console.error("Template Error:",e.responseJSON.error)}})},fetchMethod:function(e,t,n){window.fetch(e.settings.action,{mode:"cors",method:"POST",headers:new Headers(_defineProperty({"Content-Type":"application/json",Accept:"application/json","X-Requested-With":"fetch"},e.settings.csrf.name,e.settings.csrf.token)),body:JSON.stringify(t),credentials:"same-origin"}).then(function(t){return t.json().then(function(o){return t.ok?(e.settings.dev&&console.log("Success:",o),n(o),o):(console.error("Error:",o.error),Promise.reject({status:t.status,data:o}))})}).catch(function(e){return console.error("Error:",e)})}}}}]),e}();
